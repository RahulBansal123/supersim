<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Bridging SuperchainWETH - Supersim</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Supersim</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ethereum-optimism/supersim" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bridging-superchainweth"><a class="header" href="#bridging-superchainweth">Bridging SuperchainWETH</a></h1>
<p>Crosschain ETH transfers in the Superchain are facilitated through the SuperchainWETH contract. For more information on this checkout the spec for SuperchainWETH: https://specs.optimism.io/interop/superchain-weth.html.</p>
<h2 id="send-native-eth-from-chain-901-to-902-via-superchainweth"><a class="header" href="#send-native-eth-from-chain-901-to-902-via-superchainweth">Send native ETH from chain 901 to 902 via SuperchainWETH</a></h2>
<p>This outlines how to send native ETH from chain 901 to 902. To simplify these steps supersim will be run with the <code>--interop.autorelay</code> flag. The <code>--interop.autorelay</code> flag automatically triggers the relay message transaction once the initial send transaction is completed on the source chain, improving the developer experience by removing the need to manually send the relay message.</p>
<h3 id="1-start-supersim-with-the-autorelayer-enabled"><a class="header" href="#1-start-supersim-with-the-autorelayer-enabled">1. Start <code>supersim</code> with the autorelayer enabled</a></h3>
<pre><code class="language-sh">supersim --interop.autorelay 
</code></pre>
<h3 id="2-wrap-the-native-eth-to-superchainweth-on-chain-901"><a class="header" href="#2-wrap-the-native-eth-to-superchainweth-on-chain-901">2. Wrap the native ETH to SuperchainWETH on chain 901</a></h3>
<p>Wrap 10 ETH to <code>SuperchainWETH</code>. The <code>SuperchainWETH</code> contract is a predeploy at address <code>0x4200000000000000000000000000000000000024</code></p>
<pre><code class="language-sh">cast send 0x4200000000000000000000000000000000000024 "deposit()" --value 10ether --rpc-url http://127.0.0.1:9545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 
</code></pre>
<h3 id="3-check-balance-of-superchainweth-on-chain-901"><a class="header" href="#3-check-balance-of-superchainweth-on-chain-901">3. Check balance of SuperchainWETH on chain 901</a></h3>
<p>Verify that the balance of the SuperchainWETH on chain 901 has increased by <code>10000000000000000000</code>:</p>
<pre><code class="language-sh">cast balance --erc20 0x4200000000000000000000000000000000000024 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://127.0.0.1:9545
</code></pre>
<h3 id="4-initiate-the-send-transaction-on-chain-901-through-the-superchaintokenbridge"><a class="header" href="#4-initiate-the-send-transaction-on-chain-901-through-the-superchaintokenbridge">4. Initiate the send transaction on chain 901 through the SuperchainTokenBridge</a></h3>
<pre><code class="language-sh">cast send 0x4200000000000000000000000000000000000028 "sendERC20(address _token, address _to, uint256 _amount, uint256 _chainId)" 0x4200000000000000000000000000000000000024  0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 10000000000000000000 902 --rpc-url http://127.0.0.1:9545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
</code></pre>
<p><strong>5. Wait for the relayed message to appear on chain 902</strong></p>
<p>In a few seconds, you should see the RelayedMessage on chain 902:</p>
<pre><code class="language-sh"># example
INFO [08-30|14:30:14.698] SuperchainWETH#CrosschainMint to=0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 amount=10,000,000,000,000,000,000
</code></pre>
<p><strong>6. Check the balance of SuperchainWETH on chain 902</strong></p>
<p>Verify that the balance of SuperchainWETH on chain 902 has increased by 10000000000000000000:</p>
<pre><code class="language-sh">cast balance --erc20 0x4200000000000000000000000000000000000024 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://127.0.0.1:9546
</code></pre>
<p><strong>7. Unwrap the SuperchainWETH to native ETH on chain 902</strong></p>
<pre><code class="language-sh">cast send 0x4200000000000000000000000000000000000024 "withdraw(uint256)" 10000000000000000000 --rpc-url http://127.0.0.1:9546 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 
</code></pre>
<p><strong>8. Check the balance of ETH on chain 902</strong>
Verify that the balance of ETH on chain 902 has increased:</p>
<pre><code class="language-sh">cast balance 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url http://127.0.0.1:9546
</code></pre>
<h2 id="experimental-auto-wrapping-and-unwrapping-of-native-eth-and-sending-from-chain-901-to-902-using-l2-to-l2-message-passing"><a class="header" href="#experimental-auto-wrapping-and-unwrapping-of-native-eth-and-sending-from-chain-901-to-902-using-l2-to-l2-message-passing">(Experimental) auto-wrapping and unwrapping of native ETH and sending from chain 901 to 902 using L2 to L2 message passing</a></h2>
<h3 id="note-this-example-uses-a-contract-superchainethwrapper-written-for-prototyping-and-testing-purposes-this-contract-has-not-been-audited-and-it-may-contain-bugs-or-security-vulnerabilities-we-are-not-liable-for-any-issues-arising-from-its-use-it-is-strongly-advised-that-this-contract-not-be-used-with-actual-funds-and-should-only-be-used-for-testing-on-testnets-or-in-a-controlled-development-environment-this-contract-is-deployed-at-a-special-address-0x420beef000000000000000000000000000000002-only-on-the-vanilla-version-of-supersim-and-will-not-be-found-at-this-address-in-fork-mode-or-in-any-other-environments-outside-of-supersim"><a class="header" href="#note-this-example-uses-a-contract-superchainethwrapper-written-for-prototyping-and-testing-purposes-this-contract-has-not-been-audited-and-it-may-contain-bugs-or-security-vulnerabilities-we-are-not-liable-for-any-issues-arising-from-its-use-it-is-strongly-advised-that-this-contract-not-be-used-with-actual-funds-and-should-only-be-used-for-testing-on-testnets-or-in-a-controlled-development-environment-this-contract-is-deployed-at-a-special-address-0x420beef000000000000000000000000000000002-only-on-the-vanilla-version-of-supersim-and-will-not-be-found-at-this-address-in-fork-mode-or-in-any-other-environments-outside-of-supersim">Note: this example uses a contract <code>SuperchainETHWrapper</code> written for prototyping and testing purposes. This contract has not been audited and it may contain bugs or security vulnerabilities. We are not liable for any issues arising from its use. It is strongly advised that this contract not be used with actual funds and should only be used for testing on testnets or in a controlled development environment. This contract is deployed at a special address <code>0x420beeF000000000000000000000000000000002</code> only on the vanilla version of supersim and will not be found at this address in fork mode or in any other environments outside of supersim.</a></h3>
<p>In a typical L2 to L2 ETH cross-chain transfer, four transactions are required:</p>
<ol>
<li>Wrap Native ETH to SuperchainWETH on source chain</li>
<li>Send SuperchainWETH to recipient using SuperchainTokenBridge#SendERC20</li>
<li>Relay message transaction on the destination chain to receive SuperchainWETH on destination</li>
<li>Unwrap SuperchainWETH to ETH on destination chain</li>
</ol>
<p>To simplify this process, you can use the <code>SuperchainETHWrapper</code> and the <code>--interop.autorelay</code> flag to get this down to just one step. The <code>SuperchainETHWrapper#SendETH</code> function handles wrapping the native ETH to SuperchainWETH and initiating the message to relay and unwrap the SuperchainWETH on the destination. The <code>--interop.autorelay</code> flag automatically triggers the relay message transaction once the initial send transaction is completed on the source chain, improving the developer experience by removing the need to manually send the relay message.</p>
<h3 id="1-start-supersim-with-the-autorelayer-enabled-1"><a class="header" href="#1-start-supersim-with-the-autorelayer-enabled-1">1. Start <code>supersim</code> with the autorelayer enabled</a></h3>
<pre><code class="language-sh">supersim --interop.autorelay 
</code></pre>
<h3 id="2-initiate-the-send-transaction-on-chain-901"><a class="header" href="#2-initiate-the-send-transaction-on-chain-901">2. Initiate the send transaction on chain 901</a></h3>
<p>Send ETH from Chain 901 to account <code>0xCE35738E4bC96bB0a194F71B3d184809F3727f56</code> on Chain 902 using the following command:</p>
<pre><code class="language-sh">cast send 0x420beeF000000000000000000000000000000002 "sendETH(address,uint256,bytes)" 0xCE35738E4bC96bB0a194F71B3d184809F3727f56 902 0x --value 10ether --rpc-url http://127.0.0.1:9545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
</code></pre>
<h3 id="3-wait-for-the-relayed-message-to-appear-on-chain-902"><a class="header" href="#3-wait-for-the-relayed-message-to-appear-on-chain-902">3. Wait for the relayed message to appear on chain 902</a></h3>
<p>In a few seconds, you should see the RelayedMessage on chain 902:</p>
<pre><code class="language-sh"># example
INFO [08-30|14:30:14.698] SuperchainWETH#CrosschainMint to=0x420bEEF000000000000000000000000000000002 amount=10,000,000,000,000,000,000
</code></pre>
<h3 id="4-check-the-balance-on-chain-902"><a class="header" href="#4-check-the-balance-on-chain-902">4. Check the balance on chain 902</a></h3>
<p>Verify that the balance of ETH for account 0xCE35738E4bC96bB0a194F71B3d184809F3727f56 on chain 902 has increased:</p>
<pre><code class="language-sh">cast balance 0xCE35738E4bC96bB0a194F71B3d184809F3727f56 --rpc-url http://127.0.0.1:9546
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../guides/interop/cross-chain-event-reads-tictactoe.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../guides/interop/viem.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../guides/interop/cross-chain-event-reads-tictactoe.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../guides/interop/viem.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../src/static/mermaid.min.js"></script>
        <script src="../../src/static/mermaid-init.js"></script>
        <script src="../../src/static/solidity.min.js"></script>


    </div>
    </body>
</html>
